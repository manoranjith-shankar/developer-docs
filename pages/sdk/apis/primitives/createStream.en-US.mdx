import { Callout } from 'nextra-theme-docs';

# createStream

create a public or encrypted stream under a data model.

## Usage

```js
await dataverseConnector.createStream({
  modelId,
  streamContent: {
    appVersion,
    text: 'hello',
    images: [
      'https://bafkreib76wz6wewtkfmp5rhm3ep6tf4xjixvzzyh64nbyge5yhjno24yl4.ipfs.w3s.link',
    ],
    videos: [],
    createdAt,
    updatedAt,
    encrypted,
  },
});
```

## Parameters

- `modelId`: `string` - the id of the data model
- `streamContent` - `object` - the content of the stream, fields under this object are decided by the data model you are using.
  Here is an example -
  If your data model looks like this:

```graphql
type post @createModel(accountRelation: LIST, description: "post") {
  author: DID! @documentAccount
  version: CommitID! @documentVersion
  appVersion: String! @string(maxLength: 100)
  text: String @string(maxLength: 300000000)
  images: [String] @list(maxLength: 10000000) @string(maxLength: 2000000)
  videos: [String] @list(maxLength: 10000000) @string(maxLength: 2000000)
  options: String @string(maxLength: 300000000)
  createdAt: DateTime!
  updatedAt: DateTime!
}
```

and was configured in `dataverse.config.ts` like this:

```js
{
  isPublicDomain: false, // default is false
  schemaName: 'post.graphql',
  encryptable: ['text', 'images', 'videos'], // strings within the schema and within the array represent fields that may be encrypted, while fields within the schema but not within the array represent fields that will definitely not be encrypted
}
```

your `streamContent` shall be:

- `appVersion` - `string` - the version of the app under which the stream will be created
- `text` - `string` - the text content
- `images` - `string[]` - the images url
- `videos` - `string[]` - the videos url
- `createdAt` - `string` - the created time of the stream, generated by `new Date().toISOString()`
- `updatedAt` - `string` - the updated time of the stream, generated by `new Date().toISOString()`
- `encrypted` - `string` - JSON string of the fields to be encrypted or not, example:
  ```js
  JSON.stringify({
    text: false,
    images: false,
    videos: false,
  });
  ```

<Callout>
  The structure of `streamContent` needs to precisely match the structure of the
  data model, otherwise the stream will not be created.
</Callout>

## Returns

```json
{
  "pkh": "did:pkh:eip155:137:0xb4D93398f6F3FB5EE4436D1aE93b32d65693a799",
  "app": "fxy001",
  "modelId": "kjzl6hvfrbw6c7gkypf9654o0vu1jd1q85fcnyrpc1koobuys71zhp0m7kbmrvs",
  "streamId": "kjzl6kcym7w8y50yw43qgp2vk05rooezfl6fyx9hfa57rn5ij0alsl6i5am0kl4",
  "streamContent": {
    "content": {
      "text": "hello",
      "images": [
        "https://bafkreib76wz6wewtkfmp5rhm3ep6tf4xjixvzzyh64nbyge5yhjno24yl4.ipfs.w3s.link"
      ],
      "videos": [],
      "createdAt": "2023-06-09T09:30:53.416Z",
      "encrypted": "{\"text\":false,\"images\":false,\"videos\":false}",
      "updatedAt": "2023-06-09T09:30:53.416Z",
      "appVersion": "0.0.1"
    },
    "file": {
      "appVersion": "0.2.0",
      "contentId": "kjzl6kcym7w8y50yw43qgp2vk05rooezfl6fyx9hfa57rn5ij0alsl6i5am0kl4",
      "contentType": "kjzl6hvfrbw6c7gkypf9654o0vu1jd1q85fcnyrpc1koobuys71zhp0m7kbmrvs",
      "comment": { "mirrorName": "fxy001_post", "note": "", "tags": [] },
      "fileType": 0,
      "createdAt": "2023-06-09T09:30:55.908Z",
      "updatedAt": "2023-06-09T09:30:55.908Z",
      "indexFileId": "kjzl6kcym7w8y9r79gnnj4bagyn0atwb1rurmnlzv0splask1n9tr3mhfekcloo"
    }
  }
}
```
